<!DOCTYPE html>
<html lang="en">
    <meta charset="UTF-8">
        <title>Survey Challenge</title>
    </meta>
    <head>
        <link rel="stylesheet" type="text/css" href="resources/styles/survey.css">
    </head>

  <body>
  
    <div id="survey-app">
        <h1>{{ primaryH1Msg }}</h1>
        <div id="div_current_question" data-attribute-question-id:questionId>
            Survey Completion Status: {{ surveyCompletePercentage }}%<br><br>

            <span class="questionTitleSpan">{{ questionTitle }}</span><span class="questionDescriptionSpan">{{ questionDescription }}</span><br><br>

            <input type="button" id="current_form_previous_question_button" data-attribute-question-number:  value="Previous Question"><!-- style="display:none" -->
            <input type="button" id="current_form_next_question_button" value="Next Question" v-on:click="qIndex=nextQuestionIndex"><!-- style="display:none" -->
            
        </div>
    </div>

    <!-- development build of vue.js -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
    <!-- sample survey questions from http://docs.fluidsurveys.com/fluidsurveys/api/json.html --> 
    <script type="text/javascript" src="data/survey1.json"></script>
    <script>

        const mySurvey = data;
        const totalQuestionNumber = mySurvey.form[0].children.length; 
        
        let buildForm = [];
        let currentQuestionIndex = 0;
        let currentQuestionNumber = currentQuestionIndex + 1;
        let currentQuestion = mySurvey.form[0].children[currentQuestionIndex];

        // next/previous navigation logic
        buildForm.nextQuestionIndex = currentQuestionIndex + 1;
        buildForm.previousQuestionNumber = '';
        if (buildForm.currentQuestionIndex != 0) {
            buildForm.previousQuestionIndex = currentQuestionIndex - 1;
        }

        // survey status logic
        buildForm.surveyCompletePercentage = currentQuestionIndex / totalQuestionNumber * 100;
        //buildForm.surveyCompletePercentage = parseFloat(buildForm.surveyCompletePercentage).toFixed(-2)+"%";

        new Vue({
            el: "#survey-app",
            data() {
                return {
                    primaryH1Msg: mySurvey.title.en,
                    questionId: currentQuestion.id,
                    questionTitle: currentQuestion.title.en,
                    questionDescription: currentQuestion.description.en,
                    nextQuestionIndex: buildForm.nextQuestionIndex,
                    previousQuestionIndex: buildForm.previousQuestionIndex,
                    surveyCompletePercentage: buildForm.surveyCompletePercentage,
                    qIndex: currentQuestionIndex
                }
                
            }
        });

    </script>

  </body>
</html>